<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: modules/quicksearch/controller/controller-quicksearch.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: modules/quicksearch/controller/controller-quicksearch.js</h1>

    


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
* The Quicksearch module allows the user to see results based on the users query as they are typing. It loads three reuslts for each of 
* the search services available.
*
* @module Quicksearch
* @constructor
* @event quicksearch#search
*/

var BaseContoller   = require('../../core/controller/base-controller');
var BaseCollection   = require('../../core/base-collection');

var API = require('../../../js/src/utils/api');

var CollectionQuicksearchResults = require('../collections/collection-quicksearch-results');
var ViewQuicksearchResults = require('../views/view-quicksearch-results');

var LayoutQuicksearch = require('../views/layout-quicksearch');
var LayoutQuicksearchResults = require('../views/layout-quicksearch-results');
var ViewQuicksearchQuery = require('../views/view-quicksearch-query');
var ModelQuicksearchResults = require('../models/model-quicksearch-results');

module.exports = BaseContoller.extend({
    
    services: window.services,

    initialize: function(){

        this.layout = new LayoutQuicksearch({
            regions: {
                'quicksearchQuery': '#quicksearch-query',
                'quicksearchResults': '#quicksearch-results'
            }
        });

        var viewsServices = {};
        this.collectionsServices = {};

        var layoutQuicksearchResults = new LayoutQuicksearchResults();

        for(var i in this.services){

            this.collectionsServices[this.services[i]] = new CollectionQuicksearchResults();
            this.collectionsServices[this.services[i]].service = this.services[i];

            modelQuicksearchResults = new ModelQuicksearchResults({service: this.services[i]});

            viewsServices[this.services[i]] = new ViewQuicksearchResults({model: modelQuicksearchResults, collection: this.collectionsServices[this.services[i]]});

            var region = {}
            region[this.services[i]] = '#search-service-' + this.services[i];

            layoutQuicksearchResults.addRegions(region);
        }

        var quicksearchQuery = new ViewQuicksearchQuery();

        this.layout.quicksearchQuery.show(quicksearchQuery);
        this.layout.quicksearchResults.show(layoutQuicksearchResults);

        for(var i in this.services){
            layoutQuicksearchResults[this.services[i]].show(viewsServices[this.services[i]]);
        }

        this.listenTo(quicksearchQuery, 'quicksearch:search', this._doSearch.bind(this));
        this.listenTo(quicksearchQuery, 'quicksearch:setactive', this._setActive.bind(this));

    },

    _doSearch: function(query){

        for(var i in this.collectionsServices){
            this.collectionsServices[i].update(query);
        }
    },

    _setActive: function(){
        this.layout.$el.addClass('active');
    }
});</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="API.html">API</a></li><li><a href="Application.html">Application</a></li><li><a href="CollectionQuicksearchResults.html">CollectionQuicksearchResults</a></li><li><a href="Dispatcher.html">Dispatcher</a></li><li><a href="LayoutQuicksearch.html">LayoutQuicksearch</a></li><li><a href="Router.html">Router</a></li><li><a href="ViewQuicksearchQuery.html">ViewQuicksearchQuery</a></li></ul><h3>Events</h3><ul><li><a href="quicksearch.html#event:search">search</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha5</a> on Tue Oct 14 2014 14:56:58 GMT+0100 (BST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
